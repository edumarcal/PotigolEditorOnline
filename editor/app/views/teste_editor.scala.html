@import scala.collection.mutable.Queue
@(codigos: Queue[Char])
@main("Editor: principal") {
    <script>
        function update(e, tag) {
            var cursor = tag.selectionStart;
            var code = (e.keyCode ? e.keyCode : e.which);

            if(code == 9) {
                e.preventDefault(); //cancelar a função do tab de mudar o foco
                tag.value += "\t";
            } 
           
            if(code == 8 || code == 46) {
                $.post("/mensagem", {
                    caracter: e.key,
                    position: cursor,
                    action: "delete"
                });    
            }
            
            $.post("/mensagem", {
               caracter: e.key,
               position: cursor,
               action: "insert"
            });

            console.info(cursor+"\t"+e);
        }
        
        function runCode() {
            $.post("/compilar", {});
           
           window.setInterval(function() {
               $.get("/compilar", function(data) {
                   document.getElementById("resultado").innerHTML = data;
                });
          }, 3000);
            
        }
        
    </script>
    <div id="body">
        <textarea id="texto" onkeypress="update(event, this)"style="width:100%; height:300px;">@codigos</textarea>
        <button onclick="runCode()">Executar</button>
        <div id="resultado" style="font-size:30px;color:blue"></div>
    </div>
}
